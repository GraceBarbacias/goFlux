<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Flux calculation – goFlux</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./bestflux.html" rel="next">
<link href="./manualID.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-ed96de9b727972fe78a7b5d16c58bf87.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-f4f457e805d2b247f730789ca0bbc19f.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="custom.scss">
</head>

<body class="nav-sidebar docked quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./goFlux.html">goFlux</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="./images/goFlux.png" alt="" class="sidebar-logo light-content py-0 d-lg-inline d-none">
      <img src="./images/goFlux.png" alt="" class="sidebar-logo dark-content py-0 d-lg-inline d-none">
      </a>
      <div class="sidebar-tools-main">
    <a href="https://twitter.com/KarelleRheault" title="" class="quarto-navigation-tool px-1" aria-label="" target="_blank"><i class="bi bi-twitter"></i></a>
    <div class="dropdown">
      <a href="" title="" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label=""><i class="bi bi-github"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://github.com/Qepanna/goFlux/tree/master/R">
            Source code
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://github.com/Qepanna/goFlux/issues">
            Report a Bug
            </a>
          </li>
      </ul>
    </div>
</div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./install.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Installation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./import.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Import</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./manualID.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Measurement ID</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./goFlux.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">goFlux</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bestflux.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">best.flux</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./flux2pdf.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Plots</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./other.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Other functions</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Examples</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./troubleshoot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Troubleshoot</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="1">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#water-vapor-correction" id="toc-water-vapor-correction" class="nav-link active" data-scroll-target="#water-vapor-correction">Water vapor correction</a></li>
  <li><a href="#usage" id="toc-usage" class="nav-link" data-scroll-target="#usage"><strong>Usage</strong></a>
  <ul>
  <li><a href="#arguments" id="toc-arguments" class="nav-link" data-scroll-target="#arguments">Arguments</a></li>
  <li><a href="#details" id="toc-details" class="nav-link" data-scroll-target="#details">Details</a></li>
  <li><a href="#value" id="toc-value" class="nav-link" data-scroll-target="#value">Value</a></li>
  <li><a href="#example" id="toc-example" class="nav-link" data-scroll-target="#example">Example</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Flux calculation</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>The function <code>goFlux</code> calculates fluxes from a variety of greenhouse gases (CO<sub>2</sub>, CH<sub>4</sub>, N<sub>2</sub>O, NO<sub>2</sub>, NO, NH<sub>3</sub>, CO, and H<sub>2</sub>O) using both linear (LM) and non-linear (HM) <span class="citation" data-cites="hutchinson1981">(<a href="#ref-hutchinson1981" role="doc-biblioref">Hutchinson and Mosier 1981</a>)</span> flux calculation methods. The HM model for the chamber concentration <span class="math inline">\(C_t\)</span> at time <span class="math inline">\(t &gt; 0\)</span> after deployment is given by:</p>
<p><span id="eq-HM"><span class="math display">\[\mathbf{Eqn~1}~~~~~~C_t = \varphi~+~(C_0 - \varphi)e^{-~\kappa~t} \tag{1}\]</span></span></p>
<p>Where <span class="math inline">\(\varphi\)</span> is the assumed concentration of constant gas source below the surface (also known as <span class="math inline">\(C_i\)</span>), <span class="math inline">\(C_0\)</span> is the concentration in the chamber at the moment of chamber closure and <span class="math inline">\(\kappa\)</span> (kappa) determines the curvature of the model. A large kappa returns a strong curvature.</p>
<p>A maximum threshold for this parameter, kappa-max (<span class="math inline">\(k.max\)</span>), can be calculated from the linear flux estimate (<span class="math inline">\(LM.flux\)</span>), the minimal detectable flux (<span class="math inline">\(MDF\)</span>) and the time of chamber closure (<span class="math inline">\(t\)</span>) <span class="citation" data-cites="hüppi2018 christiansen2015">(<a href="#ref-hüppi2018" role="doc-biblioref">Hüppi, Felber, Krauss, Six, Leifeld, and Fuß 2018</a>; <a href="#ref-christiansen2015" role="doc-biblioref"><strong>christiansen2015?</strong></a>)</span>.</p>
<p><span id="eq-k.max"><span class="math display">\[\mathbf{Eqn~2}~~~~~~k.max = \frac{LM.flux}{MDF~\times~t} \tag{2}\]</span></span></p>
<p>Where <span class="math inline">\(LM.flux\)</span> and <span class="math inline">\(MDF\)</span> have the same units (nmol or µmol·m<sup>-2</sup>·s<sup>-1</sup>) and <span class="math inline">\(t\)</span> is in seconds. Therefore, the units of kappa-max is s<sup>-1</sup>. This limit of kappa-max is included in the <code>goFlux</code> function, so that the non-linear flux estimate cannot exceed this maximum curvature. See <a href="./bestflux.html#minimal-detectable-flux">here</a> for more details about the minimal detectable flux (MDF).</p>
<p>All flux estimates, including the MDF, are multiplied by a <span class="math inline">\(flux.term\)</span> which is used to correct for water vapor inside the chamber, as well as convert the units to obtain a term in nmol or µmol·m<sup>-2</sup>·s<sup>-1</sup>:</p>
<p><span id="eq-flux.term"><span class="math display">\[\mathbf{Eqn~3}~~~~~~flux.term = \frac{(1 - H_2O)~V~P}{A~R~T} \tag{3}\]</span></span></p>
<p>Where <span class="math inline">\(H_2O\)</span> is the water vapor in mol·mol<sup>-1</sup>, <span class="math inline">\(V\)</span> is the volume inside the chamber (+instrument and tubing) in liters, <span class="math inline">\(P\)</span> is the pressure in kPa, <span class="math inline">\(A\)</span> is the surface area inside the chamber in m<sup>2</sup>, <span class="math inline">\(R\)</span> is the universal gas constant in L·kPa·K<sup>-1</sup>·mol<sup>-1</sup>, and <span class="math inline">\(T\)</span> is the temperature inside the chamber in Kelvin. Each parameter is measured inside the chamber at <span class="math inline">\(t = 0\)</span>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Total volume = chamber + tubing + instruments
</div>
</div>
<div class="callout-body-container callout-body">
<p>Note that the total volume (Vtot) needed for the calculation of the <span class="math inline">\(flux.term\)</span>, includes the volume inside the tubing and inside your instruments. Even though these volumes may seem negligible, it is important to include them, especially when comparing flux estimates measured with different instruments.</p>
<p>The good news is, we did the research for you! Find the internal volume of each instrument compatible with the goFlux R package in this Excel spreadsheet: <a href="docs/example_auxfile.xlsx">Download</a></p>
</div>
</div>
<section id="water-vapor-correction" class="level3">
<h3 class="anchored" data-anchor-id="water-vapor-correction">Water vapor correction</h3>
<p>The “flux term” is a conversion factor used to convert the flux units. Furthermore, the <code>flux.term</code> contains a correction term to account for water vapor inside the chamber: <span class="math inline">\((1 - H_2O)\)</span>. This correction term is often overlooked, but is essential when estimating fluxes using dry mole fractions of gases, as described below.</p>
<p>During a measurement in a closed chamber system, if water vapor increases due to evapo-transpiration from soils and plants, it displaces some of the chamber air, thereby diluting all other gases. As a result, flux measurements are underestimated <span class="citation" data-cites="welles2001">(<a href="#ref-welles2001" role="doc-biblioref"><strong>welles2001?</strong></a>)</span>. That is why most manufacturers provide the dry fraction of measured gases (e.g., <code>CO2dry_ppm</code>), meaning that gas concentrations relate the dry mole fraction to the mole fraction measured in moist air by accounting for the dilution effect of water vapor. If manufacturers do not provide the dry fraction of gases, the import functions of the <em>goFlux</em> R package converts gas concentrations to their dry fractions automatically.</p>
<p>For example, to obtain the CO<sub>2</sub> flux <span class="math inline">\(F_c\)</span> in µmol·m<sup>-2</sup>·s<sup>-1</sup>, one must multiply the rate of change of the CO<sub>2</sub> mole fraction <span class="math inline">\(dC/dt\)</span> with other environmental parameters, immediately after chamber closure, as follows:</p>
<p><span id="eq-4"><span class="math display">\[
\mathbf{Eqn~4}~~~~~~F_c = \frac{V}{A}\cdot\frac{P_0}{R~T_0}\cdot\frac{dC}{dt}
\tag{4}\]</span></span></p>
<p>Where <span class="math inline">\(V\)</span> is the volume inside the chamber (+instrument and tubing) in liters, <span class="math inline">\(P_0\)</span> is the initial air pressure in kPa, <span class="math inline">\(A\)</span> is the surface area inside the chamber in m<sup>2</sup>, <span class="math inline">\(R\)</span> is the universal gas constant in L·kPa·K<sup>-1</sup>·mol<sup>-1</sup>, <span class="math inline">\(T_0\)</span> is the initial temperature inside the chamber in Kelvin. However, this equation does not account for the water vapor dilution in the chamber. To correct for water vapor dilution, one must replace <span class="math inline">\(C\)</span>, the CO<sub>2</sub> mole fraction, with the dry mole fraction <span class="math inline">\(C'\)</span>:</p>
<p><span id="eq-5"><span class="math display">\[
\mathbf{Eqn~5}~~~~~~C = C'(1~-~W)
\tag{5}\]</span></span></p>
<p>Where <span class="math inline">\(W\)</span> is the water vapor in mol·mol<sup>-1</sup>. Therefore, when we use the dry fractions of gases for calculating the rate change in gas concentration, we must also correct for water vapor dilution at the start of the measurement in the equation:</p>
<p><span id="eq-6"><span class="math display">\[
\mathbf{Eqn~6}~~~~~~F_c = \frac{V}{A}\cdot\frac{P_0(1-W_0)}{R~T_0}\cdot\frac{dC'}{dt}
\tag{6}\]</span></span></p>
<p>For a more detailed demonstration of how these equations were obtained, refer to the LI-COR support documentations of the LI-8100A instrument (<a href="https://www.licor.com/support/LI-8100A/topics/deriving-the-flux-equation.html#fc">Support &gt; LI-8100A &gt; Operating Instructions &gt; Deriving the Flux Equation: The Model</a>).</p>
</section>
<section id="usage" class="level2">
<h2 class="anchored" data-anchor-id="usage"><strong>Usage</strong></h2>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Code chunks under <strong>Usage</strong> sections are not part of the demonstration. They are meant to show you how to use the arguments in the function.</p>
</div>
</div>
<div class="cell" data-code-copy="false">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">goFlux</span>(</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  dataframe,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  gastype,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">H2O_col =</span> <span class="st">"H2O_ppm"</span>,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">prec =</span> <span class="cn">NULL</span>,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Area =</span> <span class="cn">NULL</span>,</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">offset =</span> <span class="cn">NULL</span>,</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Vtot =</span> <span class="cn">NULL</span>,</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">Vcham =</span> <span class="cn">NULL</span>,</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">Pcham =</span> <span class="cn">NULL</span>,</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">Tcham =</span> <span class="cn">NULL</span>,</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">k.mult =</span> <span class="dv">1</span>,</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">warn.length =</span> <span class="dv">60</span>,</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">k.min =</span> <span class="dv">10</span><span class="sc">^-</span><span class="dv">8</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<section id="arguments" class="level3">
<h3 class="anchored" data-anchor-id="arguments">Arguments</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<tbody>
<tr class="odd">
<td><code>dataframe</code></td>
<td>a data.frame containing gas measurements (see <code>gastype</code> below), water vapor measurements (see <code>H2O_col</code> below) and the following columns: <code>UniqueID</code>, <code>Etime</code>, <code>Vtot</code>, <code>Area</code>, <code>Pcham</code>, <code>Tcham</code> and <code>flag</code> (see the parameters <code>Vtot</code>, <code>Area</code>, <code>Pcham</code> and <code>Tcham</code> below for more details). <code>chamID</code> may be used instead of <code>UniqueID</code>.</td>
</tr>
<tr class="even">
<td><code>gastype</code></td>
<td>character string; specifies which column should be used for the flux calculations. Must be one of the following: “CO2dry_ppm”, “CH4dry_ppb”, “COdry_ppb”, “N2Odry_ppb”, “NH3dry_ppb”, “NO_ppb”, “NO2_ppb” or “H2O_ppm”.</td>
</tr>
<tr class="odd">
<td><code>H2O_col</code></td>
<td>character string; specifies which column should be used to subtract the effect of water vapor in the chamber space. Default is <code>H2O_col = "H2O_ppm"</code>.</td>
</tr>
<tr class="even">
<td><code>prec</code></td>
<td>numerical value; precision of the instruments. Units must be the same as <code>gastype</code>. With the default <code>prec = NULL</code>, instrument precision for each gas must be provided in <code>dataframe</code>.</td>
</tr>
<tr class="odd">
<td><code>Area</code></td>
<td>numerical value; area of the soil surface inside the chamber (cm<sup>2</sup>). Alternatively, provide the column <code>Area</code> in <code>dataframe</code> if <code>Area</code> is different between samples.</td>
</tr>
<tr class="even">
<td><code>offset</code></td>
<td>(optional) numerical value; height between the soil surface and the chamber (cm). Alternatively, provide the column <code>offset</code> in <code>dataframe</code> if <code>offset</code> is different between samples. <code>offset</code> is only used if <code>Vtot</code> is missing.</td>
</tr>
<tr class="odd">
<td><code>Vtot</code></td>
<td>numerical value; total volume inside the chamber, tubes, instruments, etc. (L). Alternatively, provide the column <code>Vtot</code> in <code>dataframe</code> if <code>Vtot</code> is different between samples. If <code>Vtot</code> is missing, the function will calculate it from <code>Area</code>, <code>Vcham</code> and <code>offset</code>.</td>
</tr>
<tr class="even">
<td><code>Vcham</code></td>
<td>(optional) numerical value; volume inside the chamber, tubes and instruments (L). Alternatively, provide the column <code>Vcham</code> in <code>dataframe</code> if <code>Vcham</code> is different between samples. <code>Vhcam</code> is only used if <code>Vtot</code> is missing.</td>
</tr>
<tr class="odd">
<td><code>Pcham</code></td>
<td>numerical value; pressure inside the chamber (kPa). Alternatively, provide the column <code>Pcham</code> in <code>dataframe</code> if <code>Pcham</code> is different between samples. If <code>Pcham</code> is not provided, normal atmospheric pressure (101.325 kPa) is used.</td>
</tr>
<tr class="even">
<td><code>Tcham</code></td>
<td>numerical value; temperature inside the chamber (Celsius). Alternatively, provide the column <code>Tcham</code> in <code>dataframe</code> if <code>Tcham</code> is different between samples. If <code>Tcham</code> is not provided, 15°C is used as default.</td>
</tr>
<tr class="odd">
<td><code>k.mult</code></td>
<td>numerical value; a multiplier for the allowed kappa-max. Default setting is no multiplier (<code>k.mult = 1</code>). <code>k.mult</code> cannot be negative and must be smaller or equal to 10.</td>
</tr>
<tr class="even">
<td><code>warn.length</code></td>
<td>numerical value; limit under which a measurement is flagged for being too short (<code>nb.obs &lt; warn.length</code>).</td>
</tr>
<tr class="odd">
<td><code>k.min</code></td>
<td>numerical value; a lower boundary value for kappa in the HM model. Default is <code>k.min = 10^-8</code></td>
</tr>
</tbody>
</table>
</section>
<section id="details" class="level3">
<h3 class="anchored" data-anchor-id="details">Details</h3>
<p>Flux estimate units are µmol m<sup>-2</sup>s<sup>-1</sup> (if initial concentration is ppm, e.g.&nbsp;CO2dry_ppm) and nmol m<sup>-2</sup>s<sup>-1</sup> (if initial concentration is ppb, e.g.&nbsp;CH4dry_ppb).</p>
<p>The <code>goFlux</code> function calculates flux estimates from the linear model (LM) and the Hutchinson and Mosier model (HM). The HM model is a non-linear model, whose curvature is controlled by the parameter kappa. A large kappa returns a strong curvature. A maximum threshold for this parameter, kappa-max (<code>k.max</code>), can be calculated from the linear flux estimate (<code>LM.flux</code>), the minimal detectable flux (<code>MDF</code>) and the time of chamber closure. This limit of kappa-max is included in the <code>goFlux</code> function, so that the non-linear flux estimate cannot exceed this maximum curvature. Inversely, one can set a minimal threshold for kappa: to allow for a log-like curvature, set <code>k.min</code> below 0 (ex. -1), otherwise it should be just above 0 (ex. 10^-8). <code>k.min</code> cannot be 0 as this would result in a singular gradient.</p>
<p>All flux estimates, including the <code>MDF</code>, are multiplied by a <code>flux.term</code> which is used to correct for water vapor inside the chamber, as well as convert the units to obtain a term in nmol or µmol m<sup>-2</sup>s<sup>-1</sup>.</p>
<p>The argument <code>Area</code> is in (cm<sup>2</sup>), but the output units from the <code>goFlux</code> function are in (m<sup>2</sup>). This means that there is a factor of 10,000 to convert from (cm<sup>2</sup>) to (m<sup>2</sup>). This is important to take into account if one would provide something else than an <code>Area</code> in (cm<sup>2</sup>) to the function. For example, with incubated soil samples, one may provide an amount of soil (kg) instead of an <code>Area</code>. To get the right units in that case, multiply the kilograms of soil by 10,000 to remove the conversion from (cm<sup>2</sup>) to (m<sup>2</sup>).</p>
<p>In <code>gastype</code>, the gas species listed are the ones for which this package has been adapted. Please write to the maintainer of this package for adaptation of additional gases.</p>
<p><code>warn.length</code> is the limit below which the chamber closure time is flagged for being too short (<code>nb.obs &lt; warn.length</code>). Portable greenhouse gas analyzers typically measure at a frequency of 1 Hz. Therefore, for the default setting of <code>warn.length = 60</code>, the chamber closure time should be approximately one minute (60 seconds). If the number of observations is smaller than the threshold, a warning is printed: e.g.&nbsp;“Low number of observations: UniqueID X has 59 observations”.</p>
</section>
<section id="value" class="level3">
<h3 class="anchored" data-anchor-id="value">Value</h3>
<p>The function returns a data frame with 28 columns: a <code>UniqueID</code> per measurement, 11 columns for the linear model results (linear flux estimate (<code>LM.flux</code>), initial gas concentration (<code>LM.C0</code>), final gas concentration (<code>LM.Ct</code>), slope of linear regression (<code>LM.slope</code>), mean absolute error (<code>LM.MAE</code>), root mean square error (<code>LM.RMSE</code>), Akaike’s information criterion corrected for small sample size (<code>LM.AICc</code>), standard error (<code>LM.SE</code>), relative standard error (<code>LM.se.rel</code>), coefficient of determination (<code>LM.r2</code>), and <em>p-value</em> (<code>LM.p.val</code>)), 11 columns for the non-linear model results (non-linear flux estimate (<code>HM.flux</code>), initial gas concentration (<code>HM.C0</code>), the assumed concentration of constant gas source below the surface (<code>HM.Ci</code>), slope at <code>t=0</code> (<code>HM.slope</code>), mean absolute error (<code>HM.MAE</code>), root mean square error (<code>HM.RMSE</code>), Akaike’s information criterion corrected for small sample size (<code>HM.AICc</code>), standard error (<code>HM.SE</code>), relative standard error (<code>HM.se.rel</code>), coefficient of determination (<code>HM.r2</code>), and curvature (kappa; <code>HM.k</code>), as well as the minimal detectable flux (<code>MDF</code>), the precision of the instrument (<code>prec</code>), the flux term (<code>flux.term</code>), kappa-max (<code>k.max</code>), the g factor (g.fact; <code>g.factor</code>), the number of observations used (<code>nb.obs</code>) and the true initial gas concentration (<code>C0</code>) and final gas concentration (<code>Ct</code>).</p>
</section>
<section id="example" class="level3">
<h3 class="anchored" data-anchor-id="example">Example</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(manID.UGGA)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>CO2_flux <span class="ot">&lt;-</span> <span class="fu">goFlux</span>(manID.UGGA, <span class="st">"CO2dry_ppm"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>CH4_flux <span class="ot">&lt;-</span> <span class="fu">goFlux</span>(manID.UGGA, <span class="st">"CH4dry_ppb"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Tip: Use the function on multiple files at a time
</div>
</div>
<div class="callout-body-container callout-body">
<p>To load multiple RData files at once in your environment and store them all in one object, use the function <code>map_df</code> from the package <code>purrr</code>.</p>
<p>Use the argument <code>pattern</code> to load only the files that match a pattern.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>my.files <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="at">path =</span> <span class="st">"RData"</span>, <span class="at">pattern =</span> <span class="st">"imp.RData"</span>, <span class="at">full.names =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map_df</span>(<span class="sc">~</span> <span class="fu">get</span>(<span class="fu">load</span>(.x)))</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>CO2_flux <span class="ot">&lt;-</span> <span class="fu">goFlux</span>(my.files, <span class="st">"CO2dry_ppm"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>



</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-hutchinson1981" class="csl-entry" role="listitem">
Hutchinson, G. L. and A. R. Mosier (1981). Improved Soil Cover Method for Field Measurement of Nitrous Oxide Fluxes https://doi.org/<a href="https://doi.org/10.2136/sssaj1981.03615995004500020017x">10.2136/sssaj1981.03615995004500020017x</a>. <em>Soil Science Society of America Journal</em> <strong>45</strong> (2), 311–316.
</div>
<div id="ref-hüppi2018" class="csl-entry" role="listitem">
Hüppi, Roman, Raphael Felber, Maike Krauss, Johan Six, Jens Leifeld, and Roland Fuß (2018). Restricting the nonlinearity parameter in soil greenhouse gas flux calculation for more reliable flux estimates https://doi.org/<a href="https://doi.org/10.1371/journal.pone.0200876">10.1371/journal.pone.0200876</a>. <em>PLOS ONE</em> <strong>13</strong> (7), e0200876.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("^(?:http:|https:)\/\/(?:www\.)*(qepanna\.quarto\.pub)\/.*$");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./manualID.html" class="pagination-link" aria-label="Measurement ID">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Measurement ID</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./bestflux.html" class="pagination-link" aria-label="best.flux">
        <span class="nav-page-text">best.flux</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>