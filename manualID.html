<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Identify start and end of measurements – goFlux</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./goFlux.html" rel="next">
<link href="./import.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-ed96de9b727972fe78a7b5d16c58bf87.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-f4f457e805d2b247f730789ca0bbc19f.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="custom.scss">
</head>

<body class="nav-sidebar docked quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./manualID.html">Measurement ID</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="./images/goFlux.png" alt="" class="sidebar-logo light-content py-0 d-lg-inline d-none">
      <img src="./images/goFlux.png" alt="" class="sidebar-logo dark-content py-0 d-lg-inline d-none">
      </a>
      <div class="sidebar-tools-main">
    <a href="https://twitter.com/KarelleRheault" title="" class="quarto-navigation-tool px-1" aria-label="" target="_blank"><i class="bi bi-twitter"></i></a>
    <div class="dropdown">
      <a href="" title="" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label=""><i class="bi bi-github"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://github.com/Qepanna/goFlux/tree/master/R">
            Source code
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://github.com/Qepanna/goFlux/issues">
            Report a Bug
            </a>
          </li>
      </ul>
    </div>
</div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./install.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Installation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./import.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Import</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./manualID.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Measurement ID</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./goFlux.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">goFlux</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bestflux.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">best.flux</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./flux2pdf.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Plots</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./other.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Other functions</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Examples</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./troubleshoot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Troubleshoot</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="1">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#sec-auto" id="toc-sec-auto" class="nav-link active" data-scroll-target="#sec-auto"><strong>Automatic identification of measurements</strong></a>
  <ul>
  <li><a href="#usage" id="toc-usage" class="nav-link" data-scroll-target="#usage">Usage</a></li>
  <li><a href="#arguments" id="toc-arguments" class="nav-link" data-scroll-target="#arguments">Arguments</a></li>
  <li><a href="#details" id="toc-details" class="nav-link" data-scroll-target="#details">Details</a></li>
  <li><a href="#examples" id="toc-examples" class="nav-link" data-scroll-target="#examples">Examples</a></li>
  </ul></li>
  <li><a href="#sec-manID" id="toc-sec-manID" class="nav-link" data-scroll-target="#sec-manID"><strong>Manual identification of measurements</strong></a>
  <ul>
  <li><a href="#sec-step1" id="toc-sec-step1" class="nav-link" data-scroll-target="#sec-step1"><strong>1. Create an auxiliary file</strong></a>
  <ul class="collapse">
  <li><a href="#load-the-auxfile" id="toc-load-the-auxfile" class="nav-link" data-scroll-target="#load-the-auxfile">Load the auxfile</a>
  <ul class="collapse">
  <li><a href="#as-a-text-file-.txt" id="toc-as-a-text-file-.txt" class="nav-link" data-scroll-target="#as-a-text-file-.txt">As a text file (.txt)</a></li>
  <li><a href="#as-an-excel-spreadsheet-.xlsx" id="toc-as-an-excel-spreadsheet-.xlsx" class="nav-link" data-scroll-target="#as-an-excel-spreadsheet-.xlsx">As an Excel spreadsheet (.xlsx)</a></li>
  </ul></li>
  <li><a href="#if-start-time-is-unknown" id="toc-if-start-time-is-unknown" class="nav-link" data-scroll-target="#if-start-time-is-unknown">If start time is unknown</a></li>
  </ul></li>
  <li><a href="#sec-step2" id="toc-sec-step2" class="nav-link" data-scroll-target="#sec-step2"><strong>2. Define a window of observation for each measurement</strong></a>
  <ul class="collapse">
  <li><a href="#sec-obs.win" id="toc-sec-obs.win" class="nav-link" data-scroll-target="#sec-obs.win">Usage</a></li>
  <li><a href="#arguments-1" id="toc-arguments-1" class="nav-link" data-scroll-target="#arguments-1">Arguments</a></li>
  <li><a href="#details-1" id="toc-details-1" class="nav-link" data-scroll-target="#details-1">Details</a></li>
  <li><a href="#example" id="toc-example" class="nav-link" data-scroll-target="#example">Example</a></li>
  </ul></li>
  <li><a href="#sec-step3" id="toc-sec-step3" class="nav-link" data-scroll-target="#sec-step3"><strong>3. Click on a scatter plot to identify start and end times</strong></a>
  <ul class="collapse">
  <li><a href="#usage-1" id="toc-usage-1" class="nav-link" data-scroll-target="#usage-1">Usage</a></li>
  <li><a href="#arguments-2" id="toc-arguments-2" class="nav-link" data-scroll-target="#arguments-2">Arguments</a></li>
  <li><a href="#details-2" id="toc-details-2" class="nav-link" data-scroll-target="#details-2">Details</a></li>
  <li><a href="#value" id="toc-value" class="nav-link" data-scroll-target="#value">Value</a></li>
  <li><a href="#example-1" id="toc-example-1" class="nav-link" data-scroll-target="#example-1">Example</a>
  <ul class="collapse">
  <li><a href="#sec-aux" id="toc-sec-aux" class="nav-link" data-scroll-target="#sec-aux">Additional auxiliary parameters</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Identify start and end of measurements</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>After import, the user can choose from two methods to define the start and end points of each measurement and assign a UniqueID:</p>
<ul>
<li><a href="./manualID.html#sec-auto"><strong>Automatic identification of measurements</strong></a> - based on automatic recordings of chamber opening and closing from an instrument such as the LI-COR Smart Chamber or the GAIATECH Automated ECOFlux chamber, or from a reliable auxiliary file.</li>
<li><a href="./manualID.html#sec-manID"><strong>Manual identification of measurements</strong></a> - based on <code>start.time</code>, provided separately in an auxiliary file. The function <code>obs.win</code> splits the imported data into a list of data frame (divided by <code>UniqueID</code>) and creates an observation window around the <code>start.time</code> to allow for a manual selection of the start and end points of each measurements.</li>
</ul>
<section id="sec-auto" class="level1">
<h1><strong>Automatic identification of measurements</strong></h1>
<p>If the imported file already contains the column <code>chamID</code> or <code>UniqueID</code>, the file is ready for <a href="./goFlux.html">flux calculation</a>, as long as it also contains the necessary information for flux calculation, such as <code>Vtot</code>, <code>Area</code>, <code>Pcham</code> and <code>Tcham</code>, or that they can be provided as arguments in the <code>goFlux</code> function.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Retrieve file path from example file in the goFlux package</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># using the function system.file</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>file.path <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">"extdata"</span>, <span class="st">"LI8200/LI8200.json"</span>, <span class="at">package =</span> <span class="st">"goFlux"</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Import in the environment</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>imp.LI8200 <span class="ot">&lt;-</span> <span class="fu">import.LI8200</span>(<span class="at">inputfile =</span> file.path)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Is there a column called chamID or UniqueID in this file?</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(<span class="fu">grepl</span>(<span class="st">"chamID|UniqueID"</span>, <span class="fu">names</span>(imp.LI8200)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate fluxes directly after import</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>N2O_flux <span class="ot">&lt;-</span> <span class="fu">goFlux</span>(imp.LI8200, <span class="st">"N2Odry_ppb"</span>, <span class="at">prec =</span> <span class="fl">0.4</span>, <span class="at">Vtot =</span> <span class="dv">7</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Alternatively, one may want to modify the start and end time even if there are automatic recordings of chamber closure and opening. For example, there might be a delay after chamber closure that needs to be removed.</p>
<p>In such cases, you can choose from two options:</p>
<ul>
<li>Use the function <code>autoID</code> to automatically select the measurements’ window of observation (start to end points of the measurements), add a deadband or crop the end of all measurements.</li>
<li>Use the functions <code>obs.win</code> and <code>click.peak2</code> to <a href="#sec-manID">manually select the measurements’ window of observation</a>.</li>
</ul>
<p>Both methods rely on an auxiliary file, such as field notes or the recordings of the LI-COR Smart Chamber. Alternatively, a gas measurement file containing all necessary columns (e.g., <code>start.time</code> and <code>UniqueID</code>) does not require an auxiliary file.</p>
<section id="usage" class="level2">
<h2 class="anchored" data-anchor-id="usage">Usage</h2>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Code chunks under <strong>Usage</strong> sections are not part of the demonstration. They are meant to show you how to use the arguments in the function.</p>
</div>
</div>
<div class="cell" data-code-copy="false">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoID</span>(</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  inputfile,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">auxfile =</span> <span class="cn">NULL</span>,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">obs.length =</span> <span class="cn">NULL</span>,</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">deadband =</span> <span class="dv">0</span>,</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">crop.end =</span> <span class="dv">0</span>,</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">shoulder =</span> <span class="dv">60</span>,</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">drop =</span> <span class="cn">TRUE</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="arguments" class="level2">
<h2 class="anchored" data-anchor-id="arguments">Arguments</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 3%">
<col style="width: 96%">
</colgroup>
<tbody>
<tr class="odd">
<td><code>inputfile</code></td>
<td>data.frame; output from import or align functions.</td>
</tr>
<tr class="even">
<td><code>auxfile</code></td>
<td>data.frame; auxiliary data frame containing the columns <code>start.time</code> and <code>UniqueID</code>. <code>start.time</code> must contain a date and be in POSIXct format. The time zone must be the same as the POSIX.time in <code>inputfile</code>. The default time zone for the import functions is “UTC”. A data frame from the Smart Chamber (LI-8200) can be used as an auxiliary file. In that case, <code>chamID</code> will be used instead of <code>UniqueID</code>, if <code>UniqueID</code> cannot be found.</td>
</tr>
<tr class="odd">
<td><code>obs.length</code></td>
<td>numerical; chamber closure time (seconds). Default is NULL. If <code>obs.length</code> is not provided, a column <code>obs.length</code> should be contained in <code>auxfile</code> or <code>inputfile</code>. Alternatively, <code>obs.length</code> will be calculated from <code>start.time</code> and <code>cham.open</code> or <code>end.time</code> if found in <code>auxfile</code> or <code>inputfile</code>.</td>
</tr>
<tr class="even">
<td><code>deadband</code></td>
<td>numerical; time (seconds) at the start of the measurement, after chamber closure, to be removed from the time stamps used to estimate the flux.</td>
</tr>
<tr class="odd">
<td><code>crop.end</code></td>
<td>numerical; time (seconds) at the end of the measurement, before chamber opening, to be removed from the time stamps used to estimate the flux.</td>
</tr>
<tr class="even">
<td><code>shoulder</code></td>
<td>numerical; time before and after measurement in observation window (seconds). Default is 60 seconds. If the time between two measurements is smaller than <code>shoulder</code>, the time stamps are duplicated.</td>
</tr>
<tr class="odd">
<td><code>drop</code></td>
<td>logical; if <code>drop = TRUE</code> (default), time stamps without an assigned <code>UniqueID</code> are removed from the final data frame.</td>
</tr>
</tbody>
</table>
</section>
<section id="details" class="level2">
<h2 class="anchored" data-anchor-id="details">Details</h2>
<p>Note that, if the time between two measurements is smaller than <code>shoulder</code>, the time stamps are duplicated, which can result in an output data frame larger (more rows) than the <code>inputfile</code>. Conversely, if <code>drop = TRUE</code>, time stamps without an assigned <code>UniqueID</code> are removed from the final data frame, which can result in an output data frame smaller (less rows) than the <code>inputfile</code>.</p>
</section>
<section id="examples" class="level2">
<h2 class="anchored" data-anchor-id="examples">Examples</h2>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># How to use in multiple situations:</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="do">## with a LGR instrument and an auxiliary file (.txt)</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>aux.path <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">"extdata"</span>, <span class="st">"aux_UGGA/aux_UGGA.txt"</span>, <span class="at">package =</span> <span class="st">"goFlux"</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>auxfile <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(aux.path) <span class="sc">%&gt;%</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">start.time =</span> <span class="fu">as.POSIXct</span>(start.time, <span class="at">tz =</span> <span class="st">"UTC"</span>))</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(imp.UGGA)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>autoID.UGGA <span class="ot">&lt;-</span> <span class="fu">autoID</span>(<span class="at">inputfile =</span> imp.UGGA, <span class="at">auxfile =</span> auxfile, <span class="at">obs.length =</span> <span class="dv">180</span>)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="do">## with a LI-COR instrument and the Smart Chamber as auxiliary file</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(imp.LI8200)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(imp.LI7820)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>autoID.LI7820 <span class="ot">&lt;-</span> <span class="fu">autoID</span>(<span class="at">inputfile =</span> imp.LI7820, <span class="at">deadband =</span> <span class="dv">20</span>, <span class="at">auxfile =</span> imp.LI8200)</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="do">## with the LI-6400 and no auxiliary file</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(imp.LI6400)</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>ow.LI6400 <span class="ot">&lt;-</span> <span class="fu">obs.win</span>(<span class="at">inputfile =</span> imp.LI6400, <span class="at">shoulder =</span> <span class="dv">0</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
</section>
<section id="sec-manID" class="level1">
<h1><strong>Manual identification of measurements</strong></h1>
<p>The manual identification of measurements is done in three steps:</p>
<ol type="1">
<li><a href="./manualID.html#sec-step1">Create an auxiliary file</a></li>
<li><a href="./manualID.html#sec-step2">Define a window of observation for each measurement</a></li>
<li><a href="./manualID.html#sec-step3">Click on a scatter plot to identify start and end times</a></li>
</ol>
<section id="sec-step1" class="level2">
<h2 class="anchored" data-anchor-id="sec-step1"><strong>1. Create an auxiliary file</strong></h2>
<p>The auxiliary file (<code>auxfile</code>) requires two elements: a <code>UniqueID</code> and a <code>start.time</code> for each measurement. The <code>UniqueID</code> must be <strong>unique</strong>. For example, one could combine the name of a site (733a), a plot number (C) and a subplot (C), which would give the <code>UniqueID</code> “733a_C_C”. If repeated measurements are done on the same experimental unit, then a date (e.g.&nbsp;2022-09-28) could be added to the <code>UniqueID</code> (e.g.&nbsp;“733a_C_C_220928”) to make it truly unique and easy to understand. The <code>start.time</code> must be in the format “%Y-%m-%d %H:%M:%S” (e.g.&nbsp;2022-09-28 12:17:00) to be converted to POSIXct.</p>
<p>You can <a href="docs/example_auxfile.xlsx">Download</a> an example Excel spreadsheet that you can use to create your auxiliary file.</p>
<section id="load-the-auxfile" class="level3">
<h3 class="anchored" data-anchor-id="load-the-auxfile">Load the auxfile</h3>
<p>Creating an auxiliary file with date and time can be a pain, especially while using Excel. It is recommended to save your file as .txt before import into R, to make sure that the date and time formats are appropriate (“%Y-%m-%d %H:%M:%S”, e.g.&nbsp;2022-09-28 12:17:00).</p>
<section id="as-a-text-file-.txt" class="level4">
<h4 class="anchored" data-anchor-id="as-a-text-file-.txt">As a text file (.txt)</h4>
<p>In this example, the <code>start.time</code> for each measurement (<code>UniqueID</code>) was noted manually in the field, and are provided in an auxiliary file constructed in Excel and saved as a text file (<code>aux_UGGA.txt</code>).</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>aux.path <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">"extdata"</span>, <span class="st">"aux_UGGA/aux_UGGA.txt"</span>, <span class="at">package =</span> <span class="st">"goFlux"</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>auxfile <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(aux.path) <span class="sc">%&gt;%</span> </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Use the function as.POSIXct to convert start.time to a POSIXct format</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">start.time =</span> <span class="fu">as.POSIXct</span>(start.time, <span class="at">tz =</span> <span class="st">"UTC"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>  UniqueID          start.time Area Vtot Tcham Pcham
1 733a_B_E 2022-09-28 12:36:00  324 6.17  11.0  99.4
2 733a_B_S 2022-09-28 12:31:00  324 5.84  11.0  99.4
3 733a_B_W 2022-09-28 12:26:00  324 6.40  10.9  99.4
4 733a_C_C 2022-09-28 12:17:00  324 5.61  11.0  99.4
5 733a_C_E 2022-09-28 12:21:00  324 6.00  11.0  99.4
6 733a_C_S 2022-09-28 12:11:00  324 6.36  11.1  99.4</code></pre>
</div>
</div>
</section>
<section id="as-an-excel-spreadsheet-.xlsx" class="level4">
<h4 class="anchored" data-anchor-id="as-an-excel-spreadsheet-.xlsx">As an Excel spreadsheet (.xlsx)</h4>
<p>It is also possible to load an Excel sheet into R using the function <code>read_excel</code> from the package <code>readxl</code>.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>aux.path <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">"extdata"</span>, <span class="st">"aux_UGGA/aux_UGGA.xlsx"</span>, <span class="at">package =</span> <span class="st">"goFlux"</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>auxfile.xlsx <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(aux.path)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>You’ll note that this function detects Date format and converts it to POSIXct automatically.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(auxfile.xlsx<span class="sc">$</span>start.time)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "POSIXct" "POSIXt" </code></pre>
</div>
</div>
<p>Make sure that the time zone in your <code>auxfile</code> matches the time zone in your imported gas measurements files. By default, all import functions, as well as the function <code>read_excel</code>, use the time zone UTC.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>auxfile.xlsx<span class="sc">$</span>start.time</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2022-09-28 12:36:00 UTC" "2022-09-28 12:31:00 UTC"
[3] "2022-09-28 12:26:00 UTC" "2022-09-28 12:17:00 UTC"
[5] "2022-09-28 12:21:00 UTC" "2022-09-28 12:11:00 UTC"</code></pre>
</div>
</div>
<p>In this example, the <code>auxfile</code> also contains <a href="./manualID.html#sec-aux">additional auxiliary data</a> that will be required for the flux calculation: the surface area inside the chamber (Area; cm<sup>2</sup>), the total volume inside the chamber, the tubing, and the instrument (Vtot; L), the atmospheric temperature inside the chamber (Tcham; Celsius) and the atmospheric pressure inside the chamber (Pcham; kPa).</p>
</section>
</section>
<section id="if-start-time-is-unknown" class="level3">
<h3 class="anchored" data-anchor-id="if-start-time-is-unknown">If start time is unknown</h3>
<p>If field notes did not include the <code>start.time</code> of each measurement, it is possible to quickly construct an <code>auxfile</code> by visually inspecting each gas measurement files.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Retrieve file path from example file in the goFlux package</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co"># using the function system.file</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>file.path <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">"extdata"</span>, <span class="st">"UGGA/UGGA.txt"</span>, <span class="at">package =</span> <span class="st">"goFlux"</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Import in the environment</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>imp.UGGA <span class="ot">&lt;-</span> <span class="fu">import.UGGA</span>(<span class="at">inputfile =</span> file.path)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualise data</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> imp.UGGA<span class="sc">$</span>POSIX.time, <span class="at">y =</span> imp.UGGA<span class="sc">$</span>CO2dry_ppm, <span class="co"># Data</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Time"</span>, <span class="at">ylab =</span> <span class="st">"CO2dry_ppm"</span>, <span class="co"># Labels</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">400</span>, <span class="dv">550</span>)) <span class="co"># Plot limits</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="manualID_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Tip to improve x axis time display
</div>
</div>
<div class="callout-body-container callout-body">
<p>To help visualize the time on the x axis, remove the x axis in the function <code>plot</code> and use the function <code>axis.POSIXct</code> to display the time in the desired format:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualise data</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> imp.UGGA<span class="sc">$</span>POSIX.time, <span class="at">y =</span> imp.UGGA<span class="sc">$</span>CO2dry_ppm, <span class="co"># Data</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Time"</span>, <span class="at">ylab =</span> <span class="st">"CO2dry_ppm"</span>, <span class="co"># Labels</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">400</span>, <span class="dv">550</span>), <span class="co"># Plot limits</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">xaxt =</span> <span class="st">'n'</span>) <span class="co"># remove x axis tick marks</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co"># get the right time zone from your data</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>time.zone <span class="ot">&lt;-</span> <span class="fu">attr</span>(imp.UGGA<span class="sc">$</span>POSIX.time, <span class="st">"tzone"</span>)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="co"># force axis.POSIXct to use that time zone by changing the system timezone</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.setenv</span>(<span class="at">TZ =</span> time.zone)</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="co"># add the new x axis to the plot</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="fu">axis.POSIXct</span>(<span class="dv">1</span>, <span class="at">at =</span> <span class="fu">seq</span>(<span class="fu">min</span>(imp.UGGA<span class="sc">$</span>POSIX.time), <span class="fu">max</span>(imp.UGGA<span class="sc">$</span>POSIX.time), </span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>                         <span class="at">by =</span> <span class="st">"3 mins"</span>), <span class="at">format =</span> <span class="st">"%H:%M"</span>)</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="co"># change the system timezone back to default</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.unsetenv</span>(<span class="st">"TZ"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
<p>In this example there are six measurements of approximately three minutes each. Looking at the graph, you can roughly estimate the start time of each measurement:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 19%">
<col style="width: 19%">
<col style="width: 19%">
<col style="width: 29%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Peak_#</th>
<th style="text-align: center;">UniqueID</th>
<th style="text-align: center;">start.time<br>
(estimated)</th>
<th style="text-align: center;">start.time<br>
(from field notes)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Peak_1</td>
<td style="text-align: center;">733a_C_S</td>
<td style="text-align: center;">12:12:00</td>
<td style="text-align: center;">12:11:00</td>
</tr>
<tr class="even">
<td style="text-align: center;">Peak_2</td>
<td style="text-align: center;">733a_C_C</td>
<td style="text-align: center;">12:18:00</td>
<td style="text-align: center;">12:17:00</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Peak_3</td>
<td style="text-align: center;">733a_C_E</td>
<td style="text-align: center;">12:23:00</td>
<td style="text-align: center;">12:21:00</td>
</tr>
<tr class="even">
<td style="text-align: center;">Peak_4</td>
<td style="text-align: center;">733a_B_W</td>
<td style="text-align: center;">12:27:00</td>
<td style="text-align: center;">12:26:00</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Peak_5</td>
<td style="text-align: center;">733a_B_S</td>
<td style="text-align: center;">12:33:00</td>
<td style="text-align: center;">12:31:00</td>
</tr>
<tr class="even">
<td style="text-align: center;">Peak_6</td>
<td style="text-align: center;">733a_B_E</td>
<td style="text-align: center;">12:37:00</td>
<td style="text-align: center;">12:36:00</td>
</tr>
</tbody>
</table>
<p>In the next step (2), you will define a window of observation for each measurement based on the <code>start.time</code>, the observation length (<code>obs.length</code>) and some buffer time (<code>shoulder</code>) before and after the measurement. Knowing this, it does not matter how exact your estimation is, because you can allow for more buffer before and after the measurement.</p>
</section>
</section>
<section id="sec-step2" class="level2">
<h2 class="anchored" data-anchor-id="sec-step2"><strong>2. Define a window of observation for each measurement</strong></h2>
<p>In the next step (3), you must click on the start point and the end point of each measurement in a scatter plot to identify the <code>start.time</code> and the <code>end.time</code>, using the function <code>click.peak2</code>. Before that, you must create a list of data frame containing one data frame per <code>UniqueID</code> using the function <code>obs.win</code>. In this example, this step will separate the file <code>imp.UGGA</code> into a list of 6 data frames.</p>
<p>The purpose of this step is to zoom in on each measurement in the file to help you identify the start and end time more easily. In order to correctly zoom in on each measurement, you must know the <code>start.time</code> (defined in step 1) and the observation length (<code>obs.length</code>) of each measurement. In addition, you can define some buffer time around each measurement in case the defined <code>start.time</code> is not exact. If the observation length is different for each measurement, use the longest one.</p>
<section id="sec-obs.win" class="level3">
<h3 class="anchored" data-anchor-id="sec-obs.win">Usage</h3>
<div class="cell" data-code-copy="false">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">obs.win</span>(</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  inputfile,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">auxfile =</span> <span class="cn">NULL</span>,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">gastype =</span> <span class="st">"CO2dry_ppm"</span>,</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">obs.length =</span> <span class="cn">NULL</span>,</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">shoulder =</span> <span class="dv">120</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="arguments-1" class="level3">
<h3 class="anchored" data-anchor-id="arguments-1">Arguments</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 3%">
<col style="width: 96%">
</colgroup>
<tbody>
<tr class="odd">
<td><code>inputfile</code></td>
<td>data.frame; output from import or align functions.</td>
</tr>
<tr class="even">
<td><code>auxfile</code></td>
<td>data.frame; auxiliary data frame containing the columns <code>start.time</code> and <code>UniqueID</code>. <code>start.time</code> must contain a date and be in POSIXct format. The time zone must be the same as the POSIX.time in <code>inputfile</code>. The default time zone for the import functions is “UTC”. A data frame from the Smart Chamber (LI-8200) can be used as an auxiliary file. In that case, <code>chamID</code> will be used instead of <code>UniqueID</code>, if <code>UniqueID</code> cannot be found.</td>
</tr>
<tr class="odd">
<td><code>gastype</code></td>
<td>character string; specifies which gas should be displayed on the plot to manually select start time and end time of measurements. Must be one of the following: “CO2dry_ppm”, “COdry_ppb”, “CH4dry_ppb”, “N2Odry_ppb”, “NH3dry_ppb” or “H2O_ppm”. Default is “CO2dry_ppm”.</td>
</tr>
<tr class="even">
<td><code>obs.length</code></td>
<td>numerical; chamber closure time (seconds). Default is NULL. If <code>obs.length</code> is not provided, a column <code>obs.length</code> should be contained in <code>auxfile</code> or <code>inputfile</code>. Alternatively, <code>obs.length</code> will be calculated from <code>start.time</code> and <code>cham.open</code> or <code>end.time</code> if found in <code>auxfile</code> or <code>inputfile</code>.</td>
</tr>
<tr class="odd">
<td><code>shoulder</code></td>
<td>numerical; time before and after measurement in observation window (seconds). Default is 120 seconds.</td>
</tr>
</tbody>
</table>
</section>
<section id="details-1" class="level3">
<h3 class="anchored" data-anchor-id="details-1">Details</h3>
<p>In <code>gastype</code>, the gas species listed are the ones for which this package has been adapted. Please write to the maintainer of this package for adaptation of additional gases.</p>
</section>
<section id="example" class="level3">
<h3 class="anchored" data-anchor-id="example">Example</h3>
<p>In this example, the observation length was approximately three minutes (180 seconds) for each measurement. For a <code>shoulder</code> of 60 seconds, the observation window of each measurement will show 60 seconds before the <code>start.time</code> and 240 seconds after.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>ow.UGGA <span class="ot">&lt;-</span> <span class="fu">obs.win</span>(<span class="at">inputfile =</span> imp.UGGA, <span class="at">auxfile =</span> auxfile,</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">obs.length =</span> <span class="dv">180</span>, <span class="at">shoulder =</span> <span class="dv">60</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Peak_#</th>
<th style="text-align: center;">UniqueID</th>
<th style="text-align: center;">start.time</th>
<th style="text-align: center;">obs.win min</th>
<th style="text-align: center;">obs.win max</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Peak_1</td>
<td style="text-align: center;">733a_C_S</td>
<td style="text-align: center;">12:11:00</td>
<td style="text-align: center;">12:10:00</td>
<td style="text-align: center;">12:15:00</td>
</tr>
<tr class="even">
<td style="text-align: center;">Peak_2</td>
<td style="text-align: center;">733a_C_C</td>
<td style="text-align: center;">12:17:00</td>
<td style="text-align: center;">12:16:00</td>
<td style="text-align: center;">12:21:00</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Peak_3</td>
<td style="text-align: center;">733a_C_E</td>
<td style="text-align: center;">12:21:00</td>
<td style="text-align: center;">12:20:00</td>
<td style="text-align: center;">12:25:00</td>
</tr>
<tr class="even">
<td style="text-align: center;">Peak_4</td>
<td style="text-align: center;">733a_B_W</td>
<td style="text-align: center;">12:26:00</td>
<td style="text-align: center;">12:25:00</td>
<td style="text-align: center;">12:30:00</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Peak_5</td>
<td style="text-align: center;">733a_B_S</td>
<td style="text-align: center;">12:31:00</td>
<td style="text-align: center;">12:30:00</td>
<td style="text-align: center;">12:35:00</td>
</tr>
<tr class="even">
<td style="text-align: center;">Peak_6</td>
<td style="text-align: center;">733a_B_E</td>
<td style="text-align: center;">12:36:00</td>
<td style="text-align: center;">12:35:00</td>
<td style="text-align: center;">12:40:00</td>
</tr>
</tbody>
</table>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Note that, in this example, there is an overlap between the peaks 2 and 3. Therefore, 60 seconds of the data will be duplicated in the data frames of these two <code>UniqueID</code>.</p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Tip: Use the function on multiple files at a time
</div>
</div>
<div class="callout-body-container callout-body">
<p>To <strong>load multiple RData files at once</strong> in your environment and store them all in one object, use the function <code>map_df</code> from the package <code>purrr</code>.</p>
<p>Use the argument <code>pattern</code> to load only the files that match a pattern.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>my.files <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="at">path =</span> <span class="st">"RData"</span>, <span class="at">pattern =</span> <span class="st">"imp.RData"</span>, <span class="at">full.names =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map_df</span>(<span class="sc">~</span> <span class="fu">get</span>(<span class="fu">load</span>(.x)))</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>ow.UGGA <span class="ot">&lt;-</span> <span class="fu">obs.win</span>(<span class="at">inputfile =</span> my.files, <span class="at">auxfile =</span> auxfile,</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">obs.length =</span> <span class="dv">180</span>, <span class="at">shoulder =</span> <span class="dv">60</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Pay attention to the warning message given by <code>obs.win</code></strong> when there are more than 20 measurements (which is not the case in this example). If there had been more than 20 measurements, a warning like this would appear:</p>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>WARNING! Do not loop through more than 20 measurements at a time to avoid mistakes.
You have 21 measurements in your dataset.
You should split the next step into at least 2 loops.</code></pre>
</div>
</div>
<p>In such a case, follow <a href="./manualID.html#tip-click.peak.loop">this tip</a> with the function <code>click.peak2</code></p>
</div>
</div>
</section>
</section>
<section id="sec-step3" class="level2">
<h2 class="anchored" data-anchor-id="sec-step3"><strong>3. Click on a scatter plot to identify start and end times</strong></h2>
<p>When running the function <code>click.peak2</code>, for each measurement, a window will open, in which you must click on the start point and the end point. The observation window is based on the <code>start.time</code> given in the <code>auxfile</code>, the length of the measurement (<code>obs.length</code>), and a <code>shoulder</code> before <code>start.time</code> and after <code>start.time + obs.length</code>.</p>
<section id="usage-1" class="level3">
<h3 class="anchored" data-anchor-id="usage-1">Usage</h3>
<div class="cell" data-code-copy="false">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">click.peak2</span>(</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  ow.list,</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">gastype =</span> <span class="st">"CO2dry_ppm"</span>,</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">sleep =</span> <span class="dv">3</span>,</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot.lim =</span> <span class="fu">c</span>(<span class="dv">380</span>, <span class="dv">1000</span>),</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">seq =</span> <span class="cn">NULL</span>,</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">warn.length =</span> <span class="dv">60</span>,</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">save.plots =</span> <span class="cn">NULL</span>,</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">width =</span> <span class="dv">14</span>,</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> <span class="dv">8</span>,</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">abline =</span> <span class="cn">TRUE</span>,</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">abline_corr =</span> <span class="cn">TRUE</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="arguments-2" class="level3">
<h3 class="anchored" data-anchor-id="arguments-2">Arguments</h3>
<table class="caption-top table">
<tbody>
<tr class="odd">
<td><code>ow.list</code></td>
<td>list of data.frame; output from the function <a href="./manualID.html#sec-obs.win"><code>obs.win</code></a>. Must contain the columns <code>gastype</code> (see below), <code>POSIX.time</code> and <code>UniqueID</code>.</td>
</tr>
<tr class="even">
<td><code>gastype</code></td>
<td>character string; specifies which gas should be displayed on the plot to manually select start time and end time of measurements. Must be one of the following: “CO2dry_ppm”, “COdry_ppb”, “CH4dry_ppb”, “N2Odry_ppb”, “NO2dry_ppb”, “NOdry_ppb”, “NH3dry_ppb” or “H2O_ppm”. Default is “CO2dry_ppm”.</td>
</tr>
<tr class="odd">
<td><code>sleep</code></td>
<td>numerical value; delay before closing the resulting plot. Grants a delay between measurements to visually inspect the output before processing the next measurement. Sleep must be shorter than 10 seconds. If <code>sleep = NULL</code>, the plots will not close.</td>
</tr>
<tr class="even">
<td><code>plot.lim</code></td>
<td>numerical vector of length 2; sets the Y axis limits in the plots. Default values are set for a typical gas measurement of “CO2dry_ppm” from soils: <code>plot.lim = c(380,1000)</code>.</td>
</tr>
<tr class="odd">
<td><code>seq</code></td>
<td>a numerical sequence that indicates objects in a list. By default, <code>seq = NULL</code> and the function loops through all data frames in <code>ow.list</code>.</td>
</tr>
<tr class="even">
<td><code>warn.length</code></td>
<td>numerical value; limit under which a measurement is flagged for being too short (<code>nb.obs &lt; warn.length</code>). Default value is <code>warn.length = 60</code>.</td>
</tr>
<tr class="odd">
<td><code>save.plots</code></td>
<td>character string; a file path with the extension .pdf to save the plots produced with click.peak2. By default, <code>save.plot = NULL</code> and plots are not saved.</td>
</tr>
<tr class="even">
<td><code>width</code></td>
<td>numerical value; width of the pop-up window.</td>
</tr>
<tr class="odd">
<td><code>height</code></td>
<td>numerical value; height of the pop-up window.</td>
</tr>
<tr class="even">
<td><code>abline</code></td>
<td>logical; if TRUE (default), blue vertical lines indicate <code>start.time</code> and <code>end.time</code> on both plots.</td>
</tr>
<tr class="odd">
<td><code>abline_corr</code></td>
<td>logical; if TRUE (default), red vertical lines indicate <code>start.time_corr</code> and <code>end.time_corr</code> on validation plot.</td>
</tr>
</tbody>
</table>
</section>
<section id="details-2" class="level3">
<h3 class="anchored" data-anchor-id="details-2">Details</h3>
<p>The argument <code>plot.lim</code> is used to remove any data points below and above the plot limits for a better view of the scatter plot. If the gas measurements are larger than the minimum or smaller than the maximum plot limit values, then the plot will automatically zoom in and adjust to those values. The default plot limits are set for a typical gas measurement of “CO2dry_ppm” from a soil respiration measurement: <code>plot.lim = c(380,1000)</code>, where 380 ppm is the minimum plotted concentration, which should be close to atmospheric concentration, and 1000 ppm is the maximum plotted concentration, which correspond to a maximal accumulated concentration in the chamber before considering it an outlier (e.g.&nbsp;caused by breath or gas bubble). For other gasses, the user must specify the plot limits themselves. Here are some suggestions of plot limits for the other gases:</p>
<ul>
<li>“CH4dry_ppb”: <code>plot.lim = c(2200, 1800)</code></li>
<li>“N2Odry_ppb”: <code>plot.lim = c(250, 500)</code></li>
<li>“NH3dry_ppb”: <code>plot.lim = c(0, 200)</code></li>
<li>“COdry_ppb”: <code>plot.lim = c(0, 200)</code></li>
<li>“H2O_ppm”: <code>plot.lim = c(10000, 20000)</code></li>
</ul>
<p>These values will vary depending on ecosystem type and chamber application scheme.</p>
<p>The argument <code>seq</code> is used to select a subset of data frame from the list of data frames in <code>ow.list</code>. For example, to apply the function on the first measurement in the list, set <code>seq = 1</code>, or <code>seq = seq(1,10)</code> for the first 10 measurements.</p>
<p><code>warn.length</code> is the limit below which the chamber closure time is flagged for being too short (<code>nb.obs &lt; warn.length</code>). Portable greenhouse gas analyzers typically measure at a frequency of 1 Hz. Therefore, for the default setting of <code>warn.length = 60</code>, the chamber closure time should be approximately one minute (60 seconds). If the number of observations is smaller than the threshold, a warning is printed: “Number of observations for UniqueID: ‘UniqueID’ is X observations”.</p>
<p>In <code>gastype</code>, the gas species listed are the ones for which this package has been adapted. Please write to the maintainer of this package for adaptation of additional gases.</p>
<p>The arguments <code>width</code> and <code>heigth</code> are used with the function <code>dev.new</code> to define the dimensions of the pop-up window.</p>
</section>
<section id="value" class="level3">
<h3 class="anchored" data-anchor-id="value">Value</h3>
<p>The function returns a data.frame, identical to an unlisted version of the input <code>ow.list</code>, with the additional <code>flag</code>, <code>Etime</code>, <code>start.time_corr</code>, <code>end.time_corr</code> and <code>obs.length_corr</code>.</p>
</section>
<section id="example-1" class="level3">
<h3 class="anchored" data-anchor-id="example-1">Example</h3>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>WARNING! About pop-up graphics device
</div>
</div>
<div class="callout-body-container callout-body">
<p>This function makes use of the function <code>graphics::identify()</code> which is only supported on screen devices such as X11, windows and quartz. It is therefore essential to verify that your system options are compatible with this function before running it, to avoid errors. Here is an example of how to modify your system options for graphics device:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>default.device <span class="ot">&lt;-</span> <span class="fu">getOption</span>(<span class="st">"device"</span>) <span class="co"># save default option</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">device =</span> <span class="st">"X11"</span>) <span class="co"># change system option to device = "X11"</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>After using the function <code>click.peak2</code>, remember to revert back to your default system option.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">device =</span> default.device) <span class="co"># revert back to default option </span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
<p>In this example, the observation time is 3 minutes (180 seconds) and the shoulder is 60 seconds. Therefore, the observation window shows 60 seconds before the <code>start.time</code> and 240 seconds after.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Manually identify measurements by clicking on the start and end points</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>manID.UGGA <span class="ot">&lt;-</span> <span class="fu">click.peak2</span>(ow.UGGA, <span class="at">seq =</span> <span class="dv">1</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="fig-click.peak1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-click.peak1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/click.peak1.png" id="fig-click.peak1" class="img-fluid quarto-figure quarto-figure-center anchored figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-click.peak1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1
</figcaption>
</figure>
</div>
<div id="fig-click.peak2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-click.peak2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/click.peak2.png" id="fig-click.peak2" class="img-fluid quarto-figure quarto-figure-center anchored figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-click.peak2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2
</figcaption>
</figure>
</div>
<div id="tip-click.peak.loop" class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip&nbsp;1: Multiple loops with large data sets
</div>
</div>
<div class="callout-body-container callout-body">
<p>Note that the output from the function <code>obs.win</code> is a list of data frames. The function <code>click.peak2</code> loops through all data frames in the list.</p>
<p>For more than 20 measurements, it is highly recommended to create multiple loops. This helps avoid issues with miss-clicking and repeating the process.</p>
<p>If you need to create <strong>multiple loops</strong>, use the argument <code>seq</code> in <code>click.peak2</code>:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create two loops</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>manID.UGGA<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">click.peak2</span>(ow.UGGA, <span class="at">seq =</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">10</span>))</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>manID.UGGA<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">click.peak2</span>(ow.UGGA, <span class="at">seq =</span> <span class="fu">seq</span>(<span class="dv">11</span>,<span class="dv">20</span>))</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the two objects back into one object</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>manID.UGGA <span class="ot">&lt;-</span> <span class="fu">rbind</span>(manID.UGGA<span class="fl">.1</span>, manID.UGGA<span class="fl">.2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Sleep between loops
</div>
</div>
<div class="callout-body-container callout-body">
<p>Between each measurement, the result of the function <code>click.peak2</code> is displayed for 3 seconds. To increase this delay, change the parameter <code>sleep</code> in the function <code>click.peak2</code>. To prevent the quality check plots from closing, use <code>sleep = NULL</code>.</p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Save plots
</div>
</div>
<div class="callout-body-container callout-body">
<p>Both plots generated in the function <code>click.peak2</code> can be saved as a pdf using the argument <code>save.plots</code> with a character string indicating the name of the pdf file (without the extension .pdf):</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>manID.UGGA <span class="ot">&lt;-</span> <span class="fu">click.peak2</span>(ow.UGGA, <span class="at">save.plots =</span> <span class="st">"click.peak.plots"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p><img src="images/click.peak.pdf.png" class="img-fluid"></p>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>If the number of observation is under a certain threshold (<code>warn.length = 60</code>), a warning will be given after clicking on the start and end points as such:</p>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Warning message: Number of observations for UniqueID: 733_C_C is 59 observations</code></pre>
</div>
</div>
<p>Otherwise, if the number of observation satisfies this threshold, then the following message is given instead:</p>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Good window of observation for UniqueID: 733a_C_C</code></pre>
</div>
</div>
<p>This argument can be adjusted depending on the expected number of observations in your experiment.</p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>To <strong>re-click on a single measurement</strong> based on UniqueID, see <a href="./troubleshoot.html">this example</a> shown on the <a href="./troubleshoot.html#sec-click.peak">Troubleshoot page</a>.</p>
</div>
</div>
<section id="sec-aux" class="level4">
<h4 class="anchored" data-anchor-id="sec-aux">Additional auxiliary parameters</h4>
<p>To convert the flux estimate’s units into nmol CO<sub>2</sub>/H<sub>2</sub>O m<sup>-2</sup>s<sup>-1</sup> or µmol CH<sub>4</sub>/N<sub>2</sub>O m<sup>-2</sup>s<sup>-1</sup>, the temperature inside the chamber (<code>Tcham</code>; °C) and the atmospheric pressure inside the chamber (<code>Pcham</code>; kPa) are also required. If <code>Pcham</code> and <code>Tcham</code> are missing, normal atmospheric pressure (101.325 kPa) and an air temperature of 15 °C are used as default.</p>
<p>Additionally, one must provide the surface area inside the chamber (<code>Area</code>; cm<sup>2</sup>) and the total volume in the system, including tubing, instruments and chamber (<code>Vtot</code>; L). If <code>Vtot</code> is missing, one must provide an offset (distance between the chamber and the soil surface; cm) and the volume of the chamber (<code>Vcham</code>; L). In that case, the volume inside the tubing and the instruments is considered negligible, or it should be added to <code>Vcham</code>.</p>
<p>The final output, before flux calculation with <code>goFlux</code> requires the columns: <code>UniqueID</code>, <code>Etime</code>, <code>flag</code>, <code>Vtot</code> (or <code>Vcham</code> and <code>offset</code>), <code>Area</code>, <code>Pcham</code>, <code>Tcham</code>, <code>H2O_ppm</code> and other gases.</p>


</section>
</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("^(?:http:|https:)\/\/(?:www\.)*(qepanna\.quarto\.pub)\/.*$");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./import.html" class="pagination-link" aria-label="Import">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Import</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./goFlux.html" class="pagination-link" aria-label="goFlux">
        <span class="nav-page-text">goFlux</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>